{"version":3,"sources":["zDropdown.js"],"names":["window","factory","module","exports","define","cmd","amd","zDropdown","Dropdown","options","this","init","el","destroy","bind","changeItem","update","updateItems","utils","addEventListener","type","fn","attachEvent","removeEventListener","detachEvent","fireEvent","element","event","document","createEventObject","evt","createEvent","initEvent","dispatchEvent","isElement","obj","HTMLElement","e","nodeType","style","ownerDocument","addClass","className","classList","add","removeClass","remove","replace","RegExp","split","join","closest","s","i","matches","querySelectorAll","length","item","parentElement","Function","prototype","oThis","TypeError","aArgs","Array","slice","call","arguments","fToBind","fNOP","fBound","apply","concat","tagName","toLowerCase","console","log","getElementById","display","selectTagDOM","render","skin","getAttribute","hasDisabled","dropdownWrap","createElement","dropdownDefault","dropdownArrow","dropdownContainer","appendChild","parentNode","insertBefore","addListener","elOptions","selectedIndex","items","len","push","value","text","innerText","itemHtml","selected","innerHTML","currentIndex","self","setTimeout","index","children","removeListener","selectChangeHandler","wrapClickHandler","documentClickHandler","target","srcElement","isShowContainer","nodeName","change","isDestroy","removeChild"],"mappings":"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","file":"zDropdown.min.js","sourcesContent":[" /*!\n * zDropdown\n * (c) 2017 zzetao\n * Released under the MIT License.\n */\n(function (window, factory) {\n\n  if (typeof module !== \"undefined\" && typeof exports === \"object\" && define.cmd) {\n      module.exports = factory();\n  } else if (typeof define === \"function\" && define.amd) {\n      define(function() { return factory(); });\n  } else {\n      window.zDropdown = factory();\n  }\n\n})(window, function() {\n\n// Utils\nvar utils = {\n  addEventListener: function (el, type, fn) {\n    if (el.attachEvent) {\n      return el.attachEvent(\"on\" + type, fn);\n    } else {\n      return el.addEventListener(type, fn, false);\n    }\n  },\n\n  removeEventListener: function (el, type, fn) {\n    if (el.detachEvent) {\n      return el.detachEvent(\"on\" + type, fn);\n    } else {\n      return el.removeEventListener(type, fn, false);\n    }\n  },\n\n  fireEvent: function (element, event) {\n    if (document.createEventObject) {\n      var evt = document.createEventObject();\n      return element.fireEvent(\"on\"+event,evt)\n    } else {\n      var evt = document.createEvent(\"HTMLEvents\");\n      evt.initEvent(event, true, true ); // event type,bubbling,cancelable\n      return !element.dispatchEvent(evt);\n    }\n  },\n\n  isElement: function (obj) {\n    try {\n      //Using W3 DOM2 (works for FF, Opera and Chrom)\n      return obj instanceof HTMLElement;\n    }\n    catch(e){\n      //Browsers not supporting W3 DOM2 don't have HTMLElement and\n      //an exception is thrown and we end up here. Testing some\n      //properties that all elements have. (works on IE7)\n      return (typeof obj===\"object\") &&\n        (obj.nodeType===1) && (typeof obj.style === \"object\") &&\n        (typeof obj.ownerDocument ===\"object\");\n    }\n  },\n\n  // http://youmightnotneedjquery.com/\n  addClass: function (el, className) {\n    if (el.classList)\n      el.classList.add(className);\n    else\n      el.className += ' ' + className;\n  },\n  removeClass: function (el, className) {\n    if (el.classList)\n      el.classList.remove(className);\n    else\n      el.className = el.className.replace(new RegExp('(^|\\\\b)' + className.split(' ').join('|') + '(\\\\b|$)', 'gi'), ' ');\n  },\n  closest: function (el, s) {\n    var matches = (document || ownerDocument).querySelectorAll(s),\n        i;\n    do {\n        i = matches.length;\n        while (--i >= 0 && matches.item(i) !== el) {};\n    } while ((i < 0) && (el = el.parentElement)); \n    return el;\n  }\n};\n\n// Polyfill\nif (!Function.prototype.bind) {\n  Function.prototype.bind = function(oThis) {\n    if (typeof this !== 'function') {\n      // closest thing possible to the ECMAScript 5\n      // internal IsCallable function\n      throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');\n    }\n\n    var aArgs   = Array.prototype.slice.call(arguments, 1),\n        fToBind = this,\n        fNOP    = function() {},\n        fBound  = function() {\n          return fToBind.apply(this instanceof fNOP\n                 ? this\n                 : oThis,\n                 aArgs.concat(Array.prototype.slice.call(arguments)));\n        };\n\n    if (this.prototype) {\n      // Function.prototype doesn't have a prototype property\n      fNOP.prototype = this.prototype; \n    }\n    fBound.prototype = new fNOP();\n\n    return fBound;\n  };\n}\n\nfunction Dropdown (options) {\n  this.options = options || {};\n  this.init(this.options.el);\n\n  return {\n    destroy: this.destroy.bind(this),\n    changeItem: this.changeItem.bind(this),\n    update: this.updateItems.bind(this)\n  }\n}\n\nDropdown.prototype.init = function(el){\n  if (!utils.isElement(el)) {\n    el = document.getElementById(el);\n  } else {\n    if (el.tagName.toLowerCase() !== \"select\") {\n      return console.log(\"[zDropdown]: Element is not select\");\n    }\n  }\n  if (el === null) {\n    return console.log(\"[zDropdown]: No element found -> \", el);\n  }\n\n  el.style.display = \"none\";\n  \n  this.selectTagDOM = el;\n  this.render();\n}\n\nDropdown.prototype.render = function() {\n  var options = this.options;\n\n  var skin = options.skin ? \" \" + options.skin : \"\";\n\n  var hasDisabled = this.selectTagDOM.getAttribute(\"disabled\");\n  if (hasDisabled) {\n    this.hasDisabled = true;\n    skin += \" disabled\";\n  }\n\n  var dropdownWrap = document.createElement(\"div\"),\n      dropdownDefault = document.createElement(\"div\"),\n      dropdownArrow = document.createElement(\"i\"),\n      dropdownContainer = document.createElement(\"ul\");\n\n  dropdownWrap.className = \"z-dropdown\" + skin;\n  dropdownArrow.className = \"z-dropdown-arrow\";\n  dropdownContainer.className = \"z-dropdown-container\";\n  dropdownDefault.className = \"z-dropdown-default\";\n\n  dropdownWrap.appendChild(dropdownArrow);\n  dropdownWrap.appendChild(dropdownDefault);\n  dropdownWrap.appendChild(dropdownContainer);\n\n  this.dropdownContainer = dropdownContainer;\n  this.dropdownArrow     = dropdownArrow;\n  this.dropdownWrap      = dropdownWrap;\n  this.dropdownDefault   = dropdownDefault;\n  \n  this.selectTagDOM.parentNode.insertBefore(dropdownWrap, this.selectTagDOM);\n  \n  this.updateItems();\n  this.addListener();\n}\n\n\nDropdown.prototype.updateItems = function() {\n  var elOptions = this.selectTagDOM.options;\n  var selectedIndex = elOptions.selectedIndex;\n\n  // 从 select 获取 items\n  var items = [];\n  if (elOptions.length > 0) {\n    for(var i = 0, len = elOptions.length; i < len; i++) {\n      var item = elOptions[i];\n      items.push({\n        value: item.value,\n        text: item.innerText\n      })\n    }\n  }\n  this.items = items;\n\n\n  // 拼接 items \n  var itemHtml = \"\";\n\n  for(var i = 0, len = items.length; i < len; i++) {\n    var selected = i == selectedIndex ? \"selected\" : \"\";\n    var item = items[i];\n    itemHtml += '<li class=\"' + selected + '\" index=\"' + i + '\" value=\"' + item.value + '\">' + item.text + '</li>';\n  }\n\n  this.dropdownContainer.innerHTML = itemHtml;\n  this.dropdownDefault.innerText = (items[selectedIndex] && items[selectedIndex].text) || \"none\";\n  this.currentIndex = selectedIndex;\n\n  var self = this;\n\n  // disabled\n  setTimeout(function(){\n    var hasDisabled = self.selectTagDOM.getAttribute(\"disabled\");\n    // ie hasDisabled = String, chrome hasDisabled = null\n    var toggleClass = !hasDisabled ? utils.removeClass : utils.addClass;\n    toggleClass(self.dropdownWrap, \"disabled\");\n  }, 0)\n}\n\n/**\n * 更改选择项\n * @param  {Number} index 选择项索引\n * @return \n */\nDropdown.prototype.changeItem = function(index) {\n\n  var items = this.items,\n      selectTagDOM = this.selectTagDOM,\n      dropdownContainer = this.dropdownContainer,\n      dropdownDefault = this.dropdownDefault,\n      currentIndex = this.currentIndex;\n\n  index = index || 0;\n\n  var item = items[index];\n\n  if (index > items.length || index == currentIndex) {\n    return;\n  }\n\n  dropdownDefault.innerText = item.text;\n  utils.removeClass(dropdownContainer.children[currentIndex], \"selected\");\n  utils.addClass(dropdownContainer.children[index], \"selected\");\n\n  selectTagDOM.selectedIndex = index;\n\n  this.currentIndex = index;\n}\n\nDropdown.prototype.removeListener = function(){\n  utils.removeEventListener(this.selectTagDOM, \"change\", this.selectChangeHandler);\n  utils.removeEventListener(this.dropdownWrap, \"click\", this.wrapClickHandler);\n  utils.removeEventListener(document, \"click\", this.documentClickHandler);\n}\nDropdown.prototype.addListener = function(){\n  this.wrapClickHandler     = this.wrapClickHandler.bind(this);\n  this.selectChangeHandler  = this.selectChangeHandler.bind(this);\n  this.documentClickHandler = this.documentClickHandler.bind(this);\n\n  utils.addEventListener(this.selectTagDOM, \"change\", this.selectChangeHandler);\n  utils.addEventListener(this.dropdownWrap, \"click\", this.wrapClickHandler);\n}\n\n/**\n * Dropdown 点击处理事件\n * @param  {Object} e  Event\n * @return\n */\nDropdown.prototype.wrapClickHandler = function(e) {\n  var target = e.target || e.srcElement,\n      options = this.options,\n      items = this.items;\n\n  // select 是禁用状态，点击无效\n  var hasDisabled = this.selectTagDOM.getAttribute(\"disabled\");\n  if (hasDisabled && !this.isShowContainer) {\n    return;\n  }\n\n  this.isShowContainer = !this.isShowContainer;\n\n  var toggleClass = this.isShowContainer ? utils.addClass : utils.removeClass;\n  toggleClass(this.dropdownWrap, \"active\")\n\n  // click item\n  if (target.nodeName.toLowerCase() === \"li\") {\n    var index = target.getAttribute(\"index\"),\n        item  = items[index];\n\n    this.changeItem(index);\n    utils.fireEvent(this.selectTagDOM, \"change\"); // trigger selectTagDOM change event\n    options.change && options.change(item.value, item.text, index); // change callback\n\n    utils.removeEventListener(document, \"click\", this.documentClickHandler);  \n  } else {\n    utils.addEventListener(document, \"click\", this.documentClickHandler);\n  }\n}\n\n/**\n * select 更改事件\n * @param  {Object} e Event\n * @return\n */\nDropdown.prototype.selectChangeHandler = function (e){\n  var target = e.target || e.srcElement;\n  this.changeItem(target.selectedIndex);\n}\n\nDropdown.prototype.documentClickHandler = function(e) {\n  var target = e.target || e.srcElement;\n  var parent = utils.closest(target, \".z-dropdown\");\n\n  if (!parent) {\n    this.isShowContainer = false;\n    utils.removeClass(this.dropdownWrap, \"active\");\n\n    utils.removeEventListener(document, \"click\", this.documentClickHandler);\n  }\n}\n\nDropdown.prototype.destroy = function() {\n  if (this.isDestroy) {\n    return;\n  }\n\n  this.removeListener();\n  this.dropdownWrap.parentNode.removeChild(this.dropdownWrap);\n  this.dropdownWrap = this.dropdownDefault = this.dropdownArrow = this.dropdownContainer = null;\n  this.selectTagDOM.style.display = \"\";\n  this.isDestroy = true;\n}\n\nreturn Dropdown;\n\n})"]}